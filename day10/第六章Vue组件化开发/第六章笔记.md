# 第六章 Vue 组件化开发

## 6.1 组件的概念

组件（component） 是 Vue.js 最强大的功能之一。

Vue 中的组件化开发就是把网页的重复代码抽取出来 ，封装成一个个可复用的视图组件，然后将这些视图组件拼接到一块就构成了一个完整的系统。这种方式非常灵活，可以极大的提高我们开发和维护的效率。

通常一套系统会以一棵嵌套的组件树的形式来组织：

  ![img](media\\wps568.jpg)

例如：项目可能会有头部、底部、页侧边栏、内容区等组件，每个组件又包含了其它的像导航链接、博文之  类的组件。

![img](media\\wps577.png)组件就是对局部视图的封装，每个组件包含了：
	HTML 结构
	CSS 样式
	JavaScript 行为
		data 数据
		methods 行为
![img](media\\wps577.png)提高开发效率，增强可维护性，更好的去解决软件上的**高耦合、低内聚、无重用**的3大代码问题 

![img](media\\wps577.png)Vue 中的组件思想借鉴于 React

![img](media\\wps578.png)目前主流的前端框架：Angular、React 、Vue 都是组件化开发思想

## 6.2 组件的基本使用

为了能在模板中使用，这些组件必须先注册以便 Vue 能够识别。有两种组件的注册类型：**全局注册**和**局部注册**

### 6.2.1 全局注册

#### 6.2.1.1 介绍

![img](file:///media\\wps580.png)一般把网页中特殊的公共部分注册为全局组件：轮播图、分页、通用导航栏

![img](file:///media\\wps581.png)全局注册之后，可以在任何新创建的 Vue 实例 (new Vue) 的模板中使用

![img](file:///media\\wps582.png)简单格式：

![img](file:///media\\wps583.png)

说明：

组件名：
	可使用驼峰(camelCase)或者横线分隔(kebab-case)命名方式
	但 DOM 中只能使用**横线分隔**方式进行引用组件
	官方强烈推荐组件名字母全小写且必须包含一个连字符
template：定义组件的视图模板
data ：在组件中必须是一个函数 

#### **6.2.1.2** **示例**

1. 创建 vue-05-组件化 目录，安装 vue 模块, 创建 01-全局注册.html ![img](file:///media\\wps592.png)  ![img](file:///media\\wps593.png)



### **6.2.2** **局部注册（子组件）**

#### 6.2.2.1 介绍

一般把一些非通用部分注册为局部组件，一般只适用于当前项目的。 

![img](file:///media\\wps596.png)格式：

​      ![img](file:///media\\wps594.png)

 

#### 6.2.2.2 示例

#### ![img](file:///media\\wps597.png)

 

 

### **6.2.3** **总结**

![img](file:///media\\wps598.png)组件是可复用的 Vue 实例，不需要手动实例化
![img](file:///media\\wps598.png)与 new Vue 接收相同的选项，例如 data 、 computed 、 watch 、 methods 等
![img](file:///media\\wps598.png)组件的 data 选项必须是一个函数 



## 6.3 多个组件示例

![img](file:///media\\wps608.png)效果演示

![img](file:///media\\wps609.jpg) 

![img](file:///media\\wps610.png)可将 组件注册 抽取在一个一个的 js 文件中方便管理

![img](file:///media\\wps611.png)在 vue-05-组件化 目录下创建 component 目录存放组件: Header.js Main.js Footer.js ![img](file:///media\\wps615.png)

![img](file:///media\\wps616.png)页面引入组件 js 文件后, 进行使用

![img](file:///media\\wps617.png)![img](file:///media\\wps618.png)

 

## 6.4 Bootstrap 首页组件化

### 6.4.1 分析首页

![img](file:///media\\wps620.png)分析首页可拆分为多少个组件

  ![img](file:///media\\wps623.jpg) 



共拆分为5个组件



![img](file:///media\\wps624.jpg) 

 

### 6.4.2 头部导航组件注册

1. 在 vue-05-组件化 目录下创建 03-bootstrap 目录
2. 将网盘中 01-配套源码\bootstrap 目录的所有文件复制到 03-bootstrap 目录下
3. 在 index.html 的 <body> 标签下添加一个 <div id="app"> Vue管理入口
4. 在 index.html 引入 vue.js 和 创建 Vue 实例 

 ![img](file:///media\\wps634.png)

 注册和引用头部导航组件 AppNavbar
	左上角显示 测试标题 ,通过 data 选项函数指定 message 属性显示
	输入框中失去焦点后 alert('失去焦点') , 通过 methods 选项
	在 头部导航区域采用组件形式 <navbar></navbar> 

```html
<body>
    <div id="app">
        <!--头部导航区域-->
        <navbar></navbar>
    </div>
    <script src="../node_modules/vue/dist/vue.js"></script>
    <script>
        //组件对象定义
        const AppNavbar = {
            template: `<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container-fluid">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" datatarget="#navbar" aria-expanded="false" aria-controls="navbar">
    <span class="sr-only">Toggle navigation</span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="#">{{ projectName }}</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
    <ul class="nav navbar-nav navbar-right">
    <li><a href="#">Dashboard</a></li>
    <li><a href="#">Settings</a></li>
    <li><a href="#">Profile</a></li>
    <li><a href="#">Help</a></li>
    </ul>
    <form class="navbar-form navbar-right">
    <input type="text" class="form-control" placeholder="Search..." @blur="search">
    </form>
    </div>
    </div>
    </nav>`,
            data: function () {
                return {
                    projectName: '标题'
                }
            },
            methods: {
                search() {
                    alert('失去焦点')
                }
            }
        } 
        new Vue({
            el: '#app',
            components: {
                'app-navbar': AppNavbar
            }
        })
    </script>
</body>
```

6. 浏览器访问 index.html
如果如果控制台报如下错,则 <app-navbar></app-navbar> 标签名与组件名不相同 

![img](file:///media\\wps645.jpg) 

7. 抽取定义的 AppNavbar 对象到 AppNavbar.js 中
把 const AppNavbar= {......} 部分剪切进 AppNavbar.js 文件中, AppNavbar对象添加到 window 域 ![img](file:///media\\wps650.png)

![img](file:///media\\wps651.png)将 template 提取出来

```js
; (function () {
            const template = `<nav class="navbar navbar-inverse navbar-fixed-top">
<div class="container-fluid">
<div class="navbar-header">
<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" datatarget="#navbar" aria-expanded="false" aria-controls="navbar">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="#">{{ projectName }}</a>
</div>
<div id="navbar" class="navbar-collapse collapse">
<ul class="nav navbar-nav navbar-right">
<li><a href="#">Dashboard</a></li>
<li><a href="#">Settings</a></li>
<li><a href="#">Profile</a></li>
<li><a href="#">Help</a></li>
</ul>
<form class="navbar-form navbar-right">
<input type="text" class="form-control" placeholder="Search..." @blur="search">
</form>
</div>
</div>
</nav>`
            window.Navbar = { // 添加 window 域中,html 页面才可以进行获取
                template, // 等价于template: template,
                data: function () {
                    return {
                        projectName: '梦学谷'
                    }
                },
                methods: {
                    search() {
                        alert('失去焦点')
                    }
                }
            }
        })()
```

8. 在 index.html 中引入 AppNavbar.js 

  ![img](file:///media\\wps655.png)

9. 效果

![img](file:///media\\wps656.jpg) 

10. 如果报错解决方式 ，

![img](file:///media\\wps657.png)在 index.html 中要引入 AppNavbar.js
![img](file:///media\\wps657.png)AppNavbar.js 要将 AppNavbar 放到 window 域中 

  ![img](file:///media\\wps659.jpg)

### 6.4.3 左侧导航组件注册

1. AppLeaf.js 文件中定义 AppLeaf 组件对象

![img](file:///media\\wps660.png)![img](file:///media\\wps661.png)

2. 在 index.html 中引入 AppLeaf.js , Vue实例中添加 AppLeaf 组件, 主页面通过 <app-leaf/> 组件渲染 ![img](file:///media\\wps665.png)

3. 效果

![img](file:///media\\wps666.jpg) 



### 6.4.4 右侧主页面组件注册

#### 6.4.4.1 主页面组件化

1. 在 home\AppHome.js 中定义 AppHome 组件对象 

```js
; (function () {
            const template = `<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
        <!--右边上半区域-->
        <h1 class="page-header">Dashboard</h1>
        <div class="row placeholders">
            <div class="col-xs-6 col-sm-3 placeholder">
                <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw
        ==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
                <h4>Label</h4>
                <span class="text-muted">Something else</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
                <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw
        ==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
                <h4>Label</h4>
                <span class="text-muted">Something else</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
                <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw
        ==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
                <h4>Label</h4>
                <span class="text-muted">Something else</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
                <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw
        ==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
                <h4>Label</h4>
                <span class="text-muted">Something else</span>
            </div>
        </div>
        <!--右边下半区域-->
        <h2 class="sub-header">Section title</h2>
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Header</th>
                        <th>Header</th>
                        <th>Header</th>
                        <th>Header</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1,001</td>
                        <td>Lorem</td>
                        <td>ipsum</td>
                        <td>dolor</td>
                        <td>sit</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>`
            window.AppHome = {
                template
            }
        })()
```

2. 在 index.html 中引入 components/home/AppHome.js , Vue实例添加 AppHome 组件,
主页面通过 <app-home/> 组件渲染 

```html
<body>
    <div id="app">
        <!--头部导航区域-->
        <app-navbar></app-navbar>
        <!--核心区域:分左右两边-->
        <div class="container-fluid">
            <div class="row">
                <!--左边菜单栏区域-->
                <app-leaf></app-leaf>
                <!--右边主页面区域: 分上下两个区域-->
                <app-home></app-home>
            </div>
        </div>
    </div>
    <script src="../node_modules/vue/dist/vue.js"></script>
    <!-- 注意要在 vue.js 下面引入 -->
    <script src="components/AppNavbar.js"></script>
    <script src="components/AppLeaf.js"></script>
    <script src="components/home/AppHome.js"></script>
    <script>
        new Vue({
            el: '#app',
            components: {
                AppNavbar, // 等价于 AppNavbar: AppNavbar
                AppLeaf,
                AppHome
            }
        })
    </script>
```

 

#### 6.4.4.2 Dashboard 子组件化



![img](file:///media\\wps678.png)将 AppHome.js 中的 右边上半区域 中的 <div> 部分剪切到 Dashboard 组件中，Dashboar.js 内容如下： 

```js
; (function () {
            const template = `<div class="row placeholders">
        <div class="col-xs-6 col-sm-3 placeholder">
            <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw
        ==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
            <h4>Label</h4>
            <span class="text-muted">Something else</span>
        </div>
        <div class="col-xs-6 col-sm-3 placeholder">
            <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw
        ==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
            <h4>Label</h4>
            <span class="text-muted">Something else</span>
        </div>
        <div class="col-xs-6 col-sm-3 placeholder">
            <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw
        ==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
            <h4>Label</h4>
            <span class="text-muted">Something else</span>
        </div>
        <div class="col-xs-6 col-sm-3 placeholder">
            <img src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw
        ==" width="200" height="200" class="img-responsive" alt="Generic placeholder thumbnail">
            <h4>Label</h4>
            <span class="text-muted">Something else</span>
        </div>
    </div>`
            window.Dashboard = {
                template
            }
        })()
```

2. 在 AppHome.js 中引入 Dashboard 组件作为 AppHome 的子组件
在 AppHome 对象的 components 选项中注册 Dashboard 组件
在 AppHome 对象的 template 模板中引入组件 <dashboard/> 

```js
; (function () {
            const template = `<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
        <!--右边上半区域-->
        <h1 class="page-header">Dashboard</h1>
        <dashboard></dashboard>
        <!--右边下半区域-->
        <h2 class="sub-header">Section title</h2>
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Header</th>
                        <th>Header</th>
                        <th>Header</th>
                        <th>Header</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1,001</td>
                        <td>Lorem</td>
                        <td>ipsum</td>
                        <td>dolor</td>
                        <td>sit</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>`
            window.AppHome = {
                template,
                components: { // 子组件
                    Dashboard
                }
            }
        })()
```

3. 在 index.html 中引入 Dashboard.js , 注意：Dashboard.js 要在 AppHome.js 前面引入 ![img](file:///media\\wps690.png)

4. 访问页面如果控制台报错

   ![img](file:///media\\wps691.png)在 index.html 中 Dashboard.js 要在 AppHome.js 前面引入

   ![img](file:///media\\wps692.png)Dashboard 单词不要写错了

#### 6.4.4.3 查询列表子组件化

1. 将 AppHome.js 中的 右边下半区域 中的 <div> 部分剪切到 HomeList.js 组件中， HomeList.js 内容如下： ![img](file:///media\\wps698.png)



2. 在 AppHome.js 中引入 HomeList 组件作为 Home 的子组件
在 AppHome 对象的 components 选项中注册 HomeList 组件
在 AppHome 对象的 template 模板中引入组件 <home-list/> , 注意是横线分隔方式引用组件   ![img](file:///media\\wps707.png)

3. 效果 

  ![img](file:///media\\wps708.png)

 

### 6.4.5 极致组件化



![img](file:///media\\wps709.jpg) 

#### 6.4.5.1 根组件提取 App.js

![img](file:///media\\wps712.png)将 index.html 中 <div id="#app"> 标签体中的代码提取出来，变成一个根组件存入 App.js 中 

提取的内容如下:

![img](file:///media\\wps714.png)

![img](file:///media\\wps715.png)在 03-bootstrap 目录下创建 App.js 文件 

![img](file:///media\\wps715.png)将 <div id="#app"> 标签体中的代码剪切到 App.js 文件中作为模板页面 

注意：template 模板中必须要的根元素，所以要在提取的内容外层加上 <div></div> , 一定要不要少了，不然More Actions 报以下错误：

![img](file:///media\\wps722.png) 

![img](file:///media\\wps723.png)![img](file:///media\\wps724.png)

 

#### 6.4.5.2 剪切组件对象

![img](file:///media\\wps725.png)当前 App.js 的 template 中引用了 AppNavbar 、 AppLeaf 和 AppHome 组件，所以我们要将 index.html
中的 components 选项中的组件对象**剪切**到 App 组件对象中。 

![img](file:///media\\wps731.png)代码如下：

![img](file:///media\\wps732.png)

 

#### 6.4.5.3 index.html 引入 App.js

1. 在 index.html 的引入 App.js 文件，并在 Vue 实例中的 components 选项中引入 App 组件，
然后在 <div id="app"> 下引用 </app> 

![img](file:///media\\wps739.png)![img](file:///media\\wps740.png)

2. 在 <div id="app"> 下通过 </app> 引用 App 组件不是很好, 因为页面代码中会多出一个 div 。
更好的方式是，在 <div id="app"> 下无须使用 </app> 引用 App 组件，
可以通过 Vue 根实例的 template 选项引用组件 <app></app> 后，然后会把 template 中的渲染结果替换掉
#app 标签。 

```html
<body>
    <!-- 留一个组件的出口，此处要被子组件替换 -->
    <div id="app">
    </div>
    <script src="../node_modules/vue/dist/vue.js"></script>
    <!-- 注意要在 vue.js 下面引入 -->
    <script src="components/Navbar.js"></script>
    <script src="components/Leaf.js"></script>
    <!-- 注意：Dashboard.js 和 HomeList.js 要在 Home.js 前面引入 -->
    <script src="components/Home/Dashboard.js"></script>
    <script src="components/Home/HomeList.js"></script>
    <script src="components/Home/Home.js"></script>
    <script src="App.js"></script>
    <script>
        new Vue({
            el: '#app',
            //Vue根实例中有template选项引用了组件后，然后会把template中的渲染结果替换掉 #app 标识的元素。
            template: '<app></app>',
            components: {
                App //等价于 App: App
            }
        })
    </script>
</body>
```

 3. 当前 index.html 文件中还有 JS 代码，可以将这些 JS 代码提取出来放到 main.js 中
在 03-bootstrap 目录下创建一个 main.js 文件 

剪切 Vue 实例化代码到 main.js 中 

  ![img](file:///media\\wps761.png)

![img](file:///media\\wps762.png)index.html 文件中引入 main.js 

  ![img](file:///media\\wps765.png)

 

## 6.5 组件化注意事项

![img](file:///media\\wps767.png)组件可以理解为特殊的 Vue 实例，不需要手动实例化，管理自己的 template 模板
![img](file:///media\\wps767.png)组件的 template 必须有且只有一个根节点
![img](file:///media\\wps767.png)组件的 data 选项必须是函数，且函数体返回一个对象
![img](file:///media\\wps767.png)组件与组件之间是相互独立的，可以配置自己的一些选项资源 data、methods、computed 等等
![img](file:///media\\wps767.png)思想：组件自己管理自己，不影响别人 

## 6.6 Vue 父子组件间通信

### 6.6.1 组件间通信方式

1. props 父组件向子组件传递数据
2. $emit 自定义事件
3. slot 插槽分发内容 

### 6.6.2 组件间通信规则

1. 不要在子组件中直接修改父组件传递的数据

2. 数据初始化时，应当看初始化的数据是否用于多个组件中，如果需要被用于多个组件中，则初始化在父组件  中；如果只在一个组件中使用，那就初始化在这个要使用的组件中。

3. 数据初始化在哪个组件, 更新数据的方法(函数)就应该定义在哪个组件。

### 6.6.3Props向子组件传递数据

#### 6.6.3.1 声明组件对象中定义 props

1.在声明组件对象中使用 props 选项指定 

  ![img](file:///media\\wps779.png)

 

![img](file:///media\\wps780.png)方式1：指定传递属性名，注意是 数组形式

  ![img](file:///media\\wps781.png)

![img](file:///media\\wps782.png)方式2：指定传递属性名和数据类型，注意是 对象形式

  ![img](file:///media\\wps783.png)

![img](file:///media\\wps784.png)方式3：指定属性名、数据类型、必要性、默认值![img](file:///media\\wps785.png)

#### 6.6.3.2 引用组件时动态赋值

在引用组件时，通过 v-bind 动态赋值 

  ![img](file:///media\\wps787.png)

 

 

#### 6.6.3.3 传递数据注意

1. props 只用于父组件向子组件传递数据
2. 所有标签属性都会成为组件对象的属性, 模板页面可以直接引用
3. 问题:
a. 如果需要向非子后代传递数据，必须多层逐层传递
b. 兄弟组件间也不能直接 props 通信, 必须借助父组件才可以 

### 6.6.4props案例-列表渲染

需求：实现 DashBoard 和 HomeList 组件中渲染数据功能

#### 6.6.4.1 复制 bootstrp 案例

1. 复制 vue-05-组件化\03-bootstrap 项目为 vue-06-组件间通信
2. NPM 安装 vue 模块
3. 更改 vue-06-组件间通信\index.html 中 vue.js 的路径 ![img](file:///media\\wps793.png)

4. 测试访问 index.html 正常，再进行下面操作 

#### 6.6.4.2 AppHome.js

![img](file:///media\\wps797.png)

 

#### **6.6.4.3** **Dashboard.js**

![img](file:///media\\wps798.png)



#### 6.6.4.4 HomeList.js

将 HomeList.js 中列表 <tr></tr> 抽取到一个新的 Item 组件中 

![img](file:///media\\wps802.png)

 

#### 6.6.4.5 Item.js

新增的 Item.js 位于 vue-06-组件化通信\components\home 目录下 

![img](file:///media\\wps805.png)![img](file:///media\\wps806.png)

#### 6.6.4.6 index.js 引 入 item.js

注意： 引入时的顺序和位置

  ![img](file:///media\\wps807.png)

 

### 6.6.5props案例-删除员工功能实现

#### 6.6.5.1 AppHome.js

1. 因为删除 emp 是对 empList 做更新操作，而 empList 是初始化在当前这个组件里，
所以删除的函数要定义在 AppHome.js 这个组件中
2. 向子组件传递 deleteEmp 函数 :deleteEmp="deleteEmp" 

![img](file:///media\\wps812.png)![img](file:///media\\wps813.png)

#### 6.6.5.2 HomeList.js

1. 模板中添加 <th>操作</th>
2. 父组件传递的 deleteEmp 函数在 Item.js 才会使用，所以需要通过 HomeList.js 逐层传递给 Item.js
3. 将 index 索引值 传递给 Item.js 中的组件 

![img](file:///media\\wps816.png)![img](file:///media\\wps817.png)

  

#### 6.6.5.4 Item.js

1. props 声明接收父组件传递的 deleteEmp 和 index 属性值
2. 为 删除 按钮添加点击事件 <a href="#" @click="deleteItem">删除</a>
3. 定义 deleteItem 处理函数，其中调用 AppHome.js 传递过来 deleteEmp 函数。 

![img](file:///media\\wps820.png)

### 6.6.6自定义事件

作用：通过 自定义事件 来代替 props 传入函数形式

#### **6.6.6.1** 绑定自定义

在父组件中定义事件监听函数，并引用子组件标签上 v-on 绑定事件监听 ![img](file:///media\\wps822.png)

#### 6.6.6.2 触发监听事件函数执行

在子组件中触发父组件的监听事件函数调用![img](file:///media\\wps823.png)

#### 6.6.6.3 自定义事件注意

1. 自定义事件只用于子组件向父组件发送消息(数据)

2. 隔代组件或兄弟组件间通信此种方式不合适

### 6.6.7自定义事件案例-删除仪表盘

#### 6.6.7.1 Dashboard.js

在子组件中触发父组件的监听事件函数执行删除操作  ![img](file:///media\\wps824.png)![img](file:///media\\wps825.png)

#### 6.6.7.2 AppHome.js

自定义事件删除函数deleteHobby
在引用 dashboard 组件标签上自定义事件, 绑定事件监听函数 @delete_hobby="deleteHobby" 

```js
; (function () {
            const template = `<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
        <!--右边上半区域-->
        <h1 class="page-header">Dashboard</h1>
        <!--通过自定义事件实现删除功能:
        @自定义事件名=事件监听函数
        在子组件 dashboard 中触发 delete_hobby 事件来调用 deleteHobby 函数
        -->
        <dashboard :hobbies="hobbies" @delete_hobby="deleteHobby"></dashboard>
        <!--右边下半区域-->
        <h2 class="sub-header">员工管理</h2>
        <home-list :emp-list="empList" :deleteEmp="deleteEmp"></home-list>
    </div>`
            window.AppHome = {
                template, // template: template,
                data() {
                    return {
                        hobbies: ['看书', '台球', '睡觉', '撸代码'],
                        empList: [
                            { id: 1, name: '小梦1', salary: 80001 },
                            { id: 2, name: '小梦2', salary: 80002 },
                            { id: 3, name: '小梦3', salary: 80003 },
                            { id: 4, name: '小梦4', salary: 80004 }
                        ]
                    }
                },
                methods: {
                    // 删除指定下标的数据
                    // 因为删除 emp 会对 empList 做更新操作，
                    // 而 empList 是初始化在当前这个组件里，所以删除的函数要定义在这个组件中
                    deleteEmp(index) {
                        this.empList.splice(index, 1)
                    },
                    //删除爱好
                    deleteHobby(index) {
                        this.hobbies.splice(index, 1)
                    }
                },
                components: { //Dashboard 作为AppHome 的子组件
                    Dashboard, // Dashboard: Dashboard
                    HomeList // HomeList:HomeList
                },
            }
        })()
```

注意: 删除员工有垮组件传递函数,不推荐使用自定义事件来实现删除 

### 6.6.8slot插槽

作用: 主要用于父组件向子组件传递 标签+数据 , （而上面prop和自定事件只是传递数据）
场景：一般是某个位置需要经常动态切换显示效果

 

#### 6.6.8.1 子组件定义插槽

在子组件中定义插槽, 当父组件向指定插槽传递标签数据后, 插槽处就被渲染，否则插槽处不会被渲染.

 ![img](file:///media\\wps831.png)



#### 6.6.8.2 父组件传递标签数据

  ![img](file:///media\\wps832.png)

#### 6.6.8.3 插槽注意事项

1. 只能用于父组件向子组件传递 标签+数据 

2. 传递的插槽标签中的数据处理都需要定义所在父组件中 

### 6.6.9插槽

需求： 将Dashboard 的标题通过插槽显示

#### **6.6.9.1** **AppHome.js**

将 Dashboard 的标题标签定义为插槽 <slot name="dashboard"></slot> 

![img](file:///media\\wps836.png)

#### 6.6.9.2 App.js

向子组件中定义的插槽处传递标签数据。其中标题使用 title 数据绑定  ![img](file:///media\\wps837.png)![img](file:///media\\wps838.png)

## 6.7非父子组件间通信PubSubJS(补充知识)

![img](file:///media\\wps840.png)注意：此部分内容是后面新增补充的新教程内容

### 6.7.1 介绍

Vue.js 可通过 PubSubJS 库来实现非父子组件之间的通信 ，使用 PubSubJS 的消息发布与订阅模式，来进行数据的传递。
理解：订阅信息 ==== 绑定事件监听 ，发布消息 ==== 触发事件。
注意： 但是必须先执行订阅事件 subscribe ，然后才能 publish 发布事件。 

### 6.7.2 订阅消息(绑定事件监听)

先在 created 钩子函数中订阅消息   ![img](file:///media\\wps848.png)

### 6.7.3 发布消息(触发事件)

![img](file:///media\\wps849.png)

### **6.7.4** **案例**

复制 vue-06-组件间通信 为 vue-06-组件间通信2 

需求：在右侧删除爱好数据成功后，在左侧导航栏上显示已删除的总数，没有删除则不显示数量。
分析 ：左侧导航与右侧爱好仪表盘是非父子组件，采用 PubSubJS 消息订阅发布实现功能 

  ![img](file:///media\\wps853.png)

#### 6.7.4.2 安装 pubsub-js

  ![img](file:///media\\wps854.png)

#### 6.7.4.2 index.html 引入 pubsub-js 库

​      ![img](file:///media\\wps855.png)

#### **6.7.4.3** **AppLeaf.js** **订阅消息**

初始化数量 ，在 created 钩子中订阅消息，监听当删除爱好后，进行统计已删除总数 ![img](file:///media\\wps858.png)![img](file:///media\\wps859.png)

#### 6.7.4.4 AppHome.js 发布消息

  ![img](file:///media\\wps860.png)

### 6.7.5 优点

不管是父子之间还是非父子之间通信 PubSubJS 都可以实现

## 6.8 单文件组件

### 6.8.1 当前存在的问题

上面定义组件时存在的问题:
**全局定义** **(Global definitions)** 强制要求每个 component 中的命名不得重复
**字符串模板** **(String templates)** 缺乏语法高亮，在 HTML 有多行的时候，需要用到丑陋的 \
**不支持** **CSS (No CSS support)** 意味着当 HTML 和 JavaScript 组件化时，CSS 明显被遗漏
**没有构建步骤** **(No build step)** 限制只能使用 HTML 和 ES5 JavaScript, 而不能使用预处理器，如 Pug
(formerly Jade) 和 Babel
文件扩展名为 **.vue** 的 **single-file components(****单文件组件****)** 为以上所有问题提供了解决方法，并且还可以使用
webpack 或 Browserify 等构建工具。 

### 6.8.2 单文件组件模板格式

![img](file:///media\\wps868.png)

 